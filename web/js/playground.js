/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */


// Identify playground configuration
import { default as PLAYGROUND } from './blueprints.js'
    
// Playground scripting utilities
import { default as UTILS } from './utilities.js'

//Just use the RERUM sandbox, for now.  Playground should probably have its own agent and token though.
PLAYGROUND.URLS = {
    CREATE: "http://tinydev.rerum.io/app/create",
    UPDATE: "http://tinydev.rerum.io/app/update",
    QUERY: "http://tinydev.rerum.io/app/query",
    OVERWRITE: "http://tinydev.rerum.io/app/overwrite",
    SINCE: "http://devstore.rerum.io/v1/since"
}

function initializeView(elem, equiptmentTemplate, data) {
    return new Promise((res) => {
        elem.innerHTML += PLAYGROUND[equiptmentTemplate]()
        UTILS.broadcast(undefined, PLAYGROUND.EVENTS.VIEW_RENDERED, elem, data)
        /**
         * Really each render should be a promise and we should return a Promise.all() here of some kind.
         * That would only work if DeerRender resulted in a Promise where we could return Promise.all(renderPromises).
         */
        setTimeout(res, 200) //A small hack to ensure all the HTML generated by processing the views enters the DOM before this says it has resolved.
    })
}

function initializePlaygroundSet(config) {
    return new Promise((res) => {
        const setContainer = document.getElementById("equiptmentSet")
        Array.from(config.REGISTRY).forEach(thumbnailGenerator => {
            setContainer.innerHTML += thumbnailGenerator()
        })
        UTILS.broadcast(undefined, PLAYGROUND.EVENTS.LOADED, setContainer, {})
        /**
         * Really each render should be a promise and we should return a Promise.all() here of some kind.
         * That would only work if DeerRender resulted in a Promise where we could return Promise.all(renderPromises).
         */
        setTimeout(res, 200) //A small hack to ensure all the HTML generated by processing the views enters the DOM before this says it has resolved.
    })
}


    
    